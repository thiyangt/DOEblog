<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>STA 225 2.0 Design and Analysis of Experiments</title>
    <meta charset="utf-8" />
    <meta name="author" content="Dr Thiyanga S. Talagala" />
    <meta name="date" content="2021-11-16" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css/duke-blue.css" rel="stylesheet" />
    <link href="libs/remark-css/hygge-duke.css" rel="stylesheet" />
    <link rel="stylesheet" href="libs/cc-fonts.css" type="text/css" />
    <link rel="stylesheet" href="libs/figure-captions.css" type="text/css" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# STA 225 2.0 Design and Analysis of Experiments
## Lecture 7
### Dr Thiyanga S. Talagala
### 2021-11-16

---



&lt;style&gt;

.center2 {
  margin: 0;
  position: absolute;
  top: 50%;
  left: 50%;
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}

&lt;/style&gt;

&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 30px;
}
&lt;/style&gt;



# Completely randomized design

## Advantages of CRD

- Easy to design

- Analysis of data is simple and straight forward

- Even if some values are missing the analysis can be done

## Disadvantages of CRD

- The design requires homogeneous set of experimental units

- If the experimental units are not homogeneous, error component will be large and this will make the treatment comparison less efficient.

---

# Randomized Complete Block Design (RCBD)


- Suppose we want to compare `\(r\)` treatments

- To run a CRD, we need to find `\(n_1 + n_2 + .... + n_r\)` **homogeneous** experimental units to apply treatment.

- Often it is difficult to find enough experimental homomogeneous units.

- However, it may be possible to find **several blocks of experimental units, with enough homogeneous experimental units** to apply `\(r\)` treatments.

- RCBD can be used to compare treatment means in such situations even though there are differences between blocks.

---

## Nuisance factor

A factor that has an effect on the response, but we are not interested in that effect.


- **Unknown and uncontrollable: ** *Randomization* to balance out its effect 


- **Known and uncontrollable but measurable:** *Analysis of covariance (ANCOVA)*  (at the time of the analysis)

- Nuisance source of variability is **Known and controllable**: use *Blocking* to systematically eliminate its effect on the statistical comparison among treatment means.

---

## Example

We want to test the difference between different fertilizers (A, B, C, D, E, F) on strawberry yield. The experimenter has decided to obtain four observations for each fertilizer type.

--
How many experimental units are required to compare the treatments?

---

![](farm.jpeg)

---

## Example (cont.)

The experiment is run at 4 different locations having 6 different plots of land each. Hence, a block is given by a location and an experimental unit by a plot of land.

---

## Example (cont.)

- randomized complete block design (RCBD) 

- the experimental units are homogeneous within a block

- within each block, the 6 treatments are randomly assigned to 6 experimental units

- each block (farms) contains all the treatments (fertilizer)

- the design is called **complete** because we see the complete set of treatments within every block 


---

## RCBD

In-class diagram



---

## RCBD

### Randomization:

- Number the `\(a\)`  treatments `\(1,2,â€¦,a\)`.

- First form the homogeneous blocks of the experimental units. Then allocate each treatment randomly in each block. 

    - Number the units in each block as `\(1, 2,...,a\)`.
    - Randomly allocate the `\(a\)` treatments to `\(a\)` experimental units in each block


---
## RCBD

### Replication

Since each block contains all the treatments, so every treatment will appear in all the blocks. So each
treatment can be considered as if replicated the number of times as the number of blocks. Hence, in RBD, the
number of blocks and the number of replications are same.


---


## Your turn


Question: How the 4 diets (A, B, C, and D) affect the coagulation of rabbits? 

Treatment: Diet

Factor levels: A, B, C, D

Response: Time in seconds that it takes for a cut to stop bleeding (coagulation rate).

Experimental unit: 16 rabits

Replicates: 4


There are 16 rabbits (same age, weight, height) 

---
background-image: url('bunnies.jpeg')
background-position: center
background-size: cover

## Your turn

&lt;span style="color: white;"&gt;Which approach do you use to analyze the data? CRD or RCBD&lt;/span&gt;



---

Have a jar with the letters A, B, C, D written on separate slips. Catch a rabbit, pick a slip at random from the bowl and assign the rabbit to the diet letter on the slip. Do not replace the slip. Catch the second rabbit and select another slip from the remaining three slips. Assign that treatment to the second rabbit. Continue until the first four rabbits are assigned one of the four diets. Replace the slips and repeat the procedure untill all rabbits are assigned to a diet. 

#### Which approach do you use to analyze the data? CRD or RCBD

---

## Notations

|  Block 1 	|  Block 2	|  ...	| Block b 	| 
|:---:	| :-----:	| :---:	| :---:	| 
| `\(y_{11}\)` 	|  `\(y_{12}\)`	|  ...	| `\(y_{1b}\)`	|  
| `\(y_{21}\)` 	| `\(y_{22}\)` 	| ... 	| `\(y_{2b}\)` 	| 
|  .	|  	|  	|  	|  
|  .	|  	|  	|  	|  
|  .	|  	|  	|  	| 
| `\(y_{a1}\)` 	| `\(y_{a2}\)` 	|  ...	| `\(y_{ab}\)` 	| 


Number of treatments: `\(a\)`

Number of blocks: `\(b\)`

---

"There is one observation per treatment in each block, and the order in which the treatments are run within each block is determined randomly. Because the only, randomization of treatment is within the blocks, we often say that the blocks represent **a restriction on randomization**". (Montgomery, Design and Analysis of Experiments, 2001)

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
